# UMI Scripts - Install

|[Home](Readme.md)|[Install](Install.md)|[Usage](Usage.md)|[Applications](Applications.md)|


## Standard installation

This package can by installed using the standard Perl 
[Module::Build](https://metacpan.org/pod/Module::Build) incantation.

	perl ./Build.PL
	./Build
	./Build installdeps   # if necessary
	./Build install

Otherwise, a Perl package manager may be used, such as CPAN or
[CPAN Minus](https://metacpan.org/pod/App::cpanminus). If you have downloaded this
package from GitHub, run _one_ of the following inside the package directory.

	cpan  .
	cpanm .
	cpanp .

This installation will allow the scripts to work with Fastq files. However, to use
the scripts with bam files, specifically [bam_umi_dedup.pl](apps/bam_umi_dedup.md),
follow the Advanced installation, below.


## Advanced installation

The [bam_umi_dedup](apps/bam_umi_dedup.md) application requires the installation of
the [Bio::DB::HTS](https://metacpan.org/pod/Bio::DB::HTS) Perl adapter, which in turn 
requires the external HTSlib library to be installed. 

While Bio::DB::HTS may be installed from CPAN, there are two prerequisites which
should be installed first. These are listed below.

- Install [htslib](https://github.com/samtools/htslib)

	This may already be available on your system, or available either through your OS
	package manager or an alternative package manager like [Homebrew](https://brew.sh).
	It is also included with [Samtools](https://github.com/samtools/samtools),
	although it is not installed by default.
	
	Follow the directions within for installation. Version 1.9 is officially
	recommended by the Bio::DB::HTS authors; however, later versions appear to work
	just fine and should probably be preferred. 
	[Version 1.19](https://github.com/samtools/htslib/releases/download/1.19/htslib-1.19.tar.bz2)
	have been used successfully by this author. By default, it installs into
	`/usr/local`, or it may be set to another directory (`$HOME` for example) by
	adding `--prefix=$HOME` option to the `configure` step.
	
- Install [BioPerl](https://metacpan.org/pod/BioPerl)

	The BioPerl package is a prerequiste of Bio::DB::HTS. It is a large bundle
	consisting of hundreds of modules and bundled scripts, the vast majority of which
	is not needed. Unless users have other requirements or explicit needs for
	BioPerl, it is strongly recommended to install an unofficial, custom, simplified
	[minimal version](https://github.com/tjparnell/bioperl-live/tree/minimal-tjparnell)
	generated by the author. This is considerably faster to install and has a
	footprint one-third the size of the full distribution; use this
	[file](https://github.com/tjparnell/bioperl-live/releases/download/minimal-v1.7.8/Minimal-BioPerl-1.7.8.tar.gz)
	to install.
	
	As a Perl module, it can be installed as described above.

Once these two prerequisites are installed, the remaining Perl modules can be installed.
These are listed as recommendations in `Build.PL` and are not installed automatically
as dependencies. Most Perl package managers, such as CPANMinus, CPANPlus, or CPAN 
can be used here. Use _one_ of the following, as appropriate:

	cpan  -i Bio::DB::HTS Parallel::ForkManager List::MoreUtils
	cpanm -i Bio::DB::HTS Parallel::ForkManager List::MoreUtils
	cpanp -i Bio::DB::HTS Parallel::ForkManager List::MoreUtils

If you are installing from the downloaded package directory and using CPANMinus,
you could alternatively invoke the following

	cpanm --installdeps --with-recommends .

If `htslib` is in a non-standard location, you may have to specify this manually or
run the installer interactively. The `Build.PL` script in Bio::DB::HTS accepts the 
`--htslib <PATH>` option to specify the location. If you're using `cpanm`, you could
pass the path directly with the option `--configure-args="--htslib <PATH>"`.



